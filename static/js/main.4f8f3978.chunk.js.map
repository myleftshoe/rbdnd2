{"version":3,"sources":["Demo.js","index.js"],"names":["springConfig","stiffness","damping","itemsCount","Demo","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","handleTouchStart","key","pressLocation","e","mmw","touches","handleContextMenu","handleMouseDown","pageY","handleScroll","preventDefault","stopPropagation","handleTouchMove","canStart","handleMouseMove","pos","pressY","_ref","setState","topDeltaY","mouseY","isPressed","originalPosOfLastPressed","timeout","_ref2","setTimeout","autoscroll","lastPageY","_ref3","n","min","max","_this$state","state","order","console","log","containerElement","scrollTop","currentRow","Math","round","newOrder","indexOf","arr","from","to","_arr","slice","val","splice","reinsert","handleMouseUp","clearTimeout","setContainerElement","el","range","window","addEventListener","passive","_this2","_this3","_this$state2","offset","react_default","a","createElement","ref","className","map","i","style","scale","spring","shadow","y","react_motion","_ref4","onMouseDown","bind","onTouchStart","boxShadow","concat","transform","WebkitTransform","zIndex","React","Component","ReactDOM","render","Demo_Demo","document","getElementById"],"mappings":"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","file":"static/js/main.4f8f3978.chunk.js","sourcesContent":["import React from 'react';\r\nimport {Motion, spring} from 'react-motion';\r\nimport range from 'lodash.range';\r\nimport './Demo.css'\r\n\r\nfunction reinsert(arr, from, to) {\r\n  const _arr = arr.slice(0);\r\n  const val = _arr[from];\r\n  _arr.splice(from, 1);\r\n  _arr.splice(to, 0, val);\r\n  return _arr;\r\n}\r\n\r\nfunction clamp(n, min, max) {\r\n  return Math.max(Math.min(n, max), min);\r\n}\r\n\r\nconst springConfig = {stiffness: 300, damping: 50};\r\nconst itemsCount = 50;\r\n\r\nexport default class Demo extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.containerElement = null;\r\n    this.state = {\r\n      topDeltaY: 0,\r\n      mouseY: 0,\r\n      isPressed: false,\r\n      originalPosOfLastPressed: 0,\r\n      order: range(itemsCount),\r\n    };\r\n  };\r\n\r\n  componentDidMount() {\r\n    // window.addEventListener('scroll', this.handleScroll, {passive:false});\r\n    window.addEventListener('contextmenu', this.handleScroll, {passive:false});\r\n    window.addEventListener('touchmove', this.handleTouchMove, {passive:true});\r\n    window.addEventListener('touchend', this.handleMouseUp, {passive:false});\r\n    window.addEventListener('mousemove', this.handleMouseMove, {passive:false});\r\n    window.addEventListener('mouseup', this.handleMouseUp, {passive:false});\r\n  };\r\n\r\n  handleTouchStart = (key, pressLocation, e) => {\r\n    this.mmw(key, pressLocation, e.touches[0]);\r\n  };\r\n\r\n  handleContextMenu = (key, pressLocation, e) => {\r\n    this.handleMouseDown(key, pressLocation, e.pageY);\r\n  };\r\n\r\n  handleScroll = (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    // this.handleMouseMove(e.touches[0]);\r\n  };\r\n\r\n  handleTouchMove = (e) => {\r\n    if (this.canStart) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      this.handleMouseMove(e.touches[0]);\r\n    }\r\n  };\r\n\r\n  handleMouseDown = (pos, pressY, {pageY}) => {\r\n    this.setState({\r\n      topDeltaY: pageY - pressY,\r\n      mouseY: pressY,\r\n      isPressed: true,\r\n      originalPosOfLastPressed: pos,\r\n    });\r\n  };\r\n  timeout = null;\r\n  canStart = false;\r\n  mmw = (pos, pressY, {pageY}) => {\r\n    this.timeout = setTimeout(() => {\r\n      this.canStart=true;\r\n      this.handleMouseDown(pos, pressY, {pageY})\r\n    }, 1000);\r\n  }\r\n\r\n  autoscroll = false;\r\n  lastPageY = 0;\r\n  handleMouseMove = ({pageY}) => {\r\n    const {isPressed, topDeltaY, order, originalPosOfLastPressed} = this.state;\r\n    if (isPressed) {\r\n      let mouseY = pageY - topDeltaY;\r\n      console.log(mouseY, pageY, topDeltaY);\r\n      if (pageY > 300) {\r\n        this.containerElement.scrollTop = this.containerElement.scrollTop + 10 ;\r\n        mouseY = mouseY + 10;\r\n        this.autoscroll=true;\r\n        this.lastPageY = pageY;\r\n      }\r\n      // else if (pageY < 200)\r\n      //   this.containerElement.scrollBy({top:-100, behavior:'smooth'});\r\n      else\r\n          this.containerElement.scrollTop = 0;\r\n      const currentRow = clamp(Math.round((mouseY + this.containerElement.scrollTop) / 50), 0, itemsCount - 1);\r\n      let newOrder = order;\r\n\r\n      if (currentRow !== order.indexOf(originalPosOfLastPressed)){\r\n        newOrder = reinsert(order, order.indexOf(originalPosOfLastPressed), currentRow);\r\n      }\r\n\r\n      this.setState({mouseY: mouseY, order: newOrder});\r\n    }\r\n    else {\r\n      // this.containerElement.scrollTop = this.containerElement.scrollTop + topDeltaY;\r\n    }\r\n  };\r\n\r\n  handleMouseUp = () => {\r\n    clearTimeout(this.timeout);\r\n    this.canStart=false;\r\n    this.autoscroll = false;\r\n    this.setState({isPressed: false, topDeltaY: 0});\r\n  };\r\n\r\n  componentDidUpdate() {\r\n    if (this.autoscroll)\r\n      setTimeout(() => this.handleMouseMove({pageY: this.lastPageY}), 500);\r\n  }\r\n\r\n  setContainerElement = el => {\r\n    this.containerElement = el;\r\n    // this.containerElement.addEventListener('scroll', this.handleScroll, {passive:false});\r\n  }\r\n  render() {\r\n    const {mouseY, isPressed, originalPosOfLastPressed, order} = this.state;\r\n    const offset = this.containerElement ? this.containerElement.scrollTop : 0;\r\n    return (\r\n      <div ref={this.setContainerElement} className=\"demo8\">\r\n        {range(itemsCount).map(i => {\r\n          const style = originalPosOfLastPressed === i && isPressed\r\n            ? {\r\n                scale: spring(1.0, springConfig),\r\n                shadow: spring(12, springConfig),\r\n                y: mouseY + offset,\r\n              }\r\n            : {\r\n                scale: spring(1, springConfig),\r\n                shadow: spring(1, springConfig),\r\n                y: spring(order.indexOf(i) * 50 , springConfig),\r\n              };\r\n          return (\r\n            <Motion style={style} key={i}>\r\n              {({scale, shadow, y}) =>\r\n                <div\r\n                  onMouseDown={this.mmw.bind(null, i, y)}\r\n                  onTouchStart={this.handleTouchStart.bind(null, i, y)}\r\n                  className=\"demo8-item\"\r\n                  style={{\r\n                    boxShadow: `rgba(0, 0, 0, 0.2) 0px ${shadow}px ${2 * shadow}px 0px`,\r\n                    transform: `translate3d(0, ${y}px, 0) scale(${scale})`,\r\n                    WebkitTransform: `translate3d(0, ${y}px, 0) scale(${scale})`,\r\n                    zIndex: i === originalPosOfLastPressed ? 99 : i,\r\n                  }}>\r\n                  {order.indexOf(i) + 1}\r\n                </div>\r\n              }\r\n            </Motion>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  };\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Demo from './Demo';\r\n\r\nReactDOM.render(<Demo />, document.getElementById('root'));"],"sourceRoot":""}